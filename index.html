<!DOCTYPE html>
<html lang="id">
<head>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@shaunlee/alpinejs-router@1.x.x/dist/cdn.min.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="ðŸ«˜ WarkopKM9 - Sungai Liat | Kopi Berkualitas & Suasana Nyaman! ðŸª Tempat Nongkrong Asik ðŸ¥ªðŸªðŸ¥¤ Menu Kopi, Makanan & Minuman ðŸ“± Pesan Online Sekarang! â­ðŸ›µ">
  <meta name="keywords" content="warkop km9, kopi sungai liat, kafe bangka, kopi nusantara, kopi premium, tempat nongkrong, wifi kafe, kopi enak, makanan kafe, minuman kopi, kopi susu, kopi hitam, cappuccino, latte, kopi manual brew, kopi arabica, kopi robusta, warkop modern, kafe cozy, pesan kopi online">
  <meta name="author" content="WarkopKM9 Official">
  <meta name="robots" content="index, follow">

  <!-- Meta tags Open Graph yang akan diupdate secara dinamis -->
  <meta property="og:title" id="og-title" content="ðŸ«˜ WarkopKM9 - Sungai Liat | Kopi Berkualitas & Suasana Nyaman!">
  <meta property="og:description" id="og-description" content="ðŸª Tempat Nongkrong Asik ðŸ¥ªðŸªðŸ¥¤ Menu Kopi, Makanan & Minuman ðŸ“± Pesan Online Sekarang! â­ðŸ›µ">
  <meta property="og:image" id="og-image" content="https://i.pinimg.com/1200x/26/a3/af/26a3af6550fce0e9cd3cdfff27346fd6.jpg">
  <meta property="og:url" id="og-url" content="https://warkopkm9-sungailiat.vercel.app/">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" id="twitter-title" content="ðŸ«˜ WarkopKM9 - Sungai Liat | Kopi Berkualitas & Suasana Nyaman!">
  <meta name="twitter:description" id="twitter-description" content="ðŸª Tempat Nongkrong Asik ðŸ¥ªðŸªðŸ¥¤ Menu Kopi, Makanan & Minuman ðŸ“± Pesan Online Sekarang! â­ðŸ›µ">
  <meta name="twitter:image" id="twitter-image" content="https://i.pinimg.com/1200x/26/a3/af/26a3af6550fce0e9cd3cdfff27346fd6.jpg">
  <title>WarkopKM9 - Sungai Liat</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    /* CSS styles remain unchanged from the original code */
    :root {
      --primary-color: #5D4037;
      --secondary-color: #3E2723;
      --accent-color: #FF9800;
      --light-color: #EFEBE9;
      --dark-color: #212121;
      --text-color: #333;
      --light-text: #F5F5F5;
      --success-color: #4CAF50;
      --danger-color: #F44336;
      --warning-color: #FF9800;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f5f5f5;
      color: var(--text-color);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* Header & Navigation */
    header {
      background-color: var(--primary-color);
      color: var(--light-text);
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
      transition: all 0.3s ease;
      will-change: transform;
    }

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 5%;
      max-width: 1400px;
      margin: 0 auto;
    }

    .logo {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--light-text);
    }

    .logo img {
      height: 40px;
      margin-right: 10px;
    }

    .logo h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
    }

    nav ul {
      display: flex;
      list-style: none;
    }

    nav ul li {
      margin-left: 25px;
    }

    nav ul li a {
      color: var(--light-text);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    nav ul li a:hover {
      color: var(--accent-color);
    }

    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: var(--light-text);
      font-size: 1.5rem;
      cursor: pointer;
    }

    /* Sticky Search Bar */
    .sticky-search {
      position: fixed;
      top: 70px;
      left: 0;
      width: 100%;
      background-color: white;
      padding: 15px 5%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      z-index: 999;
      transform: translateY(-100%);
      transition: transform 0.3s ease;
      display: flex;
      justify-content: center;
    }

    .sticky-search.active {
      transform: translateY(0);
    }

    .sticky-search-container {
      max-width: 1200px;
      width: 100%;
      display: flex;
      justify-content: center;
      position: relative;
    }

    .sticky-search-input {
      width: 100%;
      max-width: 400px;
      padding: 12px 20px;
      border: 2px solid var(--primary-color);
      border-radius: 30px;
      font-family: inherit;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .sticky-search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 2px 15px rgba(255, 152, 0, 0.3);
    }

    /* Search Suggestions */
    .search-suggestions {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 400px;
      background-color: white;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
      max-height: 400px;
      overflow-y: auto;
      z-index: 1001;
      display: none;
    }

    .search-suggestions.active {
      display: block;
      animation: fadeInDown 0.3s ease;
    }

    .suggestion-item {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .suggestion-item:last-child {
      border-bottom: none;
    }

    .suggestion-item:hover {
      background-color: #f9f9f9;
    }

    .suggestion-image {
      width: 50px;
      height: 50px;
      border-radius: 5px;
      overflow: hidden;
      margin-right: 15px;
      flex-shrink: 0;
    }

    .suggestion-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .suggestion-details {
      flex-grow: 1;
    }

    .suggestion-name {
      font-weight: 500;
      margin-bottom: 5px;
      color: var(--primary-color);
    }

    .suggestion-description {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 5px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .suggestion-price {
      font-weight: 600;
      color: var(--accent-color);
      font-size: 0.9rem;
    }

    .suggestion-category {
      display: inline-block;
      background-color: var(--light-color);
      color: var(--primary-color);
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 0.75rem;
      margin-top: 5px;
    }

    .no-suggestions {
      padding: 20px;
      text-align: center;
      color: #666;
      font-style: italic;
    }

    /* Hero Section */
    .hero {
      height: 100vh;
      background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://i.pinimg.com/1200x/26/a3/af/26a3af6550fce0e9cd3cdfff27346fd6.jpg');
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: var(--light-text);
      padding-top: 70px; /* Offset for fixed header */
    }

    .hero-content {
      max-width: 800px;
      padding: 0 20px;
    }

    .hero h1 {
      font-family: 'Playfair Display', serif;
      font-size: 3.5rem;
      margin-bottom: 20px;
      animation: fadeInDown 1s ease;
    }

    .hero p {
      font-size: 1.2rem;
      margin-bottom: 30px;
      animation: fadeInUp 1s ease;
    }

    .btn-primary {
      display: inline-block;
      padding: 12px 30px;
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      border-radius: 4px;
      font-weight: 500;
      transition: all 0.3s ease;
      animation: fadeInUp 1s ease 0.2s both;
      border: none;
      cursor: pointer;
    }

    .btn-primary:hover {
      background-color: #F57C00;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
    }
    
    main > section {
      padding-top: 100px; /* Offset for fixed header for all main sections */
      margin-top: -70px; /* Counteract padding to keep scroll position correct */
    }

    /* About Section */
    .about {
      padding: 80px 5%;
      background-color: white;
    }

    .section-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      text-align: center;
      margin-bottom: 20px;
      color: var(--primary-color);
    }

    .section-subtitle {
      text-align: center;
      max-width: 700px;
      margin: 0 auto 50px;
      color: #666;
    }

    .about-content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 50px;
      align-items: center;
    }

    .about-text {
      font-size: 1.1rem;
    }

    .about-image {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .about-image img {
      width: 100%;
      height: auto;
      display: block;
      transition: transform 0.5s ease;
    }

    .about-image:hover img {
      transform: scale(1.05);
    }

    /* Menu Section */
    .menu {
      padding: 80px 5%;
      background-color: var(--light-color);
    }

    .menu-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .menu-categories {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
    }

    .category-btn {
      background: none;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
      padding: 10px 25px;
      margin: 0 10px 15px;
      border-radius: 30px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-btn.active,
    .category-btn:hover {
      background-color: var(--primary-color);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(93, 64, 55, 0.3);
    }

    .search-container {
      position: relative;
      width: 300px;
      margin-bottom: 15px;
    }

    .search-input {
      width: 100%;
      padding: 10px 40px 10px 15px;
      border: 2px solid var(--primary-color);
      border-radius: 30px;
      font-family: inherit;
      transition: all 0.3s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 2px 10px rgba(255, 152, 0, 0.2);
    }

    .search-btn {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: var(--primary-color);
      cursor: pointer;
      padding: 5px 10px;
    }

    /* Menu Search Suggestions */
    .menu-search-suggestions {
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      background-color: white;
      border-radius: 0 0 10px 10px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
      max-height: 400px;
      overflow-y: auto;
      z-index: 1001;
      display: none;
    }

    .menu-search-suggestions.active {
      display: block;
      animation: fadeInDown 0.3s ease;
    }

    .menu-items {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 30px;
    }

    .menu-card {
      background-color: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      will-change: transform;
    }

    .menu-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .menu-card-image {
      height: 200px;
      overflow: hidden;
    }

    .menu-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .menu-card:hover .menu-card-image img {
      transform: scale(1.1);
    }

    .menu-card-content {
      padding: 20px;
    }

    .menu-card-title {
      font-size: 1.3rem;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .menu-card-description {
      color: #666;
      margin-bottom: 15px;
      font-size: 0.9rem;
    }

    .menu-card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .menu-card-price {
      font-weight: 600;
      color: var(--accent-color);
      font-size: 1.1rem;
    }

    .menu-card-order {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .menu-card-order:hover {
      background-color: var(--secondary-color);
      transform: scale(1.05);
    }

    /* Gallery Section */
    .gallery {
      padding: 80px 5%;
      background-color: white;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }

    .gallery-item {
      position: relative;
      height: 250px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .gallery-item:hover img {
      transform: scale(1.1);
    }

    .gallery-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
      display: flex;
      align-items: flex-end;
      padding: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .gallery-item:hover .gallery-overlay {
      opacity: 1;
    }

    .gallery-title {
      color: white;
      font-weight: 600;
    }

    /* Testimonials Section */
    .testimonials {
      padding: 80px 5%;
      background-color: var(--light-color);
    }

    .testimonials-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 30px;
    }

    .testimonial-card {
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      position: relative;
      transition: transform 0.3s ease;
    }

    .testimonial-card:hover {
      transform: translateY(-5px);
    }

    .testimonial-card::before {
      content: '"';
      font-family: 'Playfair Display', serif;
      font-size: 5rem;
      color: var(--primary-color);
      opacity: 0.1;
      position: absolute;
      top: 10px;
      left: 20px;
    }

    .testimonial-text {
      margin-bottom: 20px;
      font-style: italic;
      position: relative;
      z-index: 1;
    }

    .testimonial-author {
      display: flex;
      align-items: center;
    }

    .testimonial-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      margin-right: 15px;
      object-fit: cover;
    }

    .testimonial-name {
      font-weight: 600;
      color: var(--primary-color);
    }

    .testimonial-role {
      font-size: 0.9rem;
      color: #666;
    }

    /* Contact Section */
    .contact {
      padding: 80px 5%;
      background-color: white;
    }

    .contact-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 50px;
    }

    .contact-info {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .contact-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 30px;
    }

    .contact-icon {
      background-color: var(--primary-color);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 20px;
      font-size: 1.2rem;
    }

    .contact-text h3 {
      font-size: 1.2rem;
      margin-bottom: 5px;
      color: var(--primary-color);
    }

    .contact-form {
      background-color: var(--light-color);
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .form-control {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: inherit;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .form-control:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2);
    }

    textarea.form-control {
      resize: vertical;
      min-height: 120px;
    }

    .btn-submit {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn-submit:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    /* Footer */
    footer {
      background-color: var(--secondary-color);
      color: var(--light-text);
      padding: 50px 5% 20px;
    }

    .footer-container {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin-bottom: 30px;
    }

    .footer-column h3 {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      margin-bottom: 20px;
      color: var(--accent-color);
    }

    .footer-column p {
      margin-bottom: 15px;
    }

    .footer-column ul {
      list-style: none;
    }

    .footer-column ul li {
      margin-bottom: 10px;
    }

    .footer-column ul li a {
      color: var(--light-text);
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .footer-column ul li a:hover {
      color: var(--accent-color);
    }

    .social-links {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .social-link {
      width: 40px;
      height: 40px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .social-link:hover {
      background-color: var(--accent-color);
      transform: translateY(-3px);
    }

    .footer-bottom {
      text-align: center;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.9rem;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: var(--primary-color);
      color: white;
      padding: 15px 20px;
      border-radius: 4px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transform: translateX(150%);
      transition: transform 0.3s ease;
      z-index: 3000;
      max-width: 300px;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      background-color: var(--success-color);
    }

    .toast.error {
      background-color: var(--danger-color);
    }

    /* Order Modal */
    .order-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      overflow-y: auto;
    }

    .order-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .order-container {
      background-color: white;
      width: 90%;
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 10px;
      position: relative;
      animation: fadeInUp 0.5s ease;
    }

    .order-header {
      background-color: var(--primary-color);
      color: white;
      padding: 20px;
      border-radius: 10px 10px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .order-header h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
    }

    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .close-btn:hover {
      transform: rotate(90deg);
    }

    .order-content {
      padding: 30px;
    }

    .order-steps {
      display: flex;
      justify-content: space-between;
      margin-bottom: 30px;
      position: relative;
    }

    .order-steps::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 0;
      width: 100%;
      height: 2px;
      background-color: #ddd;
      z-index: 0;
    }

    .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 1;
    }

    .step-number {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      margin-bottom: 10px;
      transition: background-color 0.3s ease;
    }

    .step.active .step-number {
      background-color: var(--primary-color);
      color: white;
    }

    .step.completed .step-number {
      background-color: var(--success-color);
      color: white;
    }

    .step-title {
      font-size: 0.9rem;
      text-align: center;
    }

    .order-step-content {
      display: none;
    }

    .order-step-content.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    /* Product Summary - NEW: Added to show selected products at the top */
    .product-summary {
      background-color: var(--light-color);
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .product-summary h3 {
      margin-bottom: 15px;
      color: var(--primary-color);
      font-size: 1.2rem;
    }

    .summary-items {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .summary-item {
      display: flex;
      align-items: center;
      padding: 10px;
      background-color: white;
      border-radius: 6px;
      box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    }

    .summary-item-image {
      width: 50px;
      height: 50px;
      border-radius: 6px;
      overflow: hidden;
      margin-right: 15px;
    }

    .summary-item-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .summary-item-details {
      flex-grow: 1;
    }

    .summary-item-name {
      font-weight: 500;
      margin-bottom: 5px;
    }

    .summary-item-price {
      color: var(--accent-color);
      font-size: 0.9rem;
    }

    .summary-item-quantity {
      display: flex;
      align-items: center;
      margin-left: 15px;
    }

    .quantity-badge {
      background-color: var(--primary-color);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    .product-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .product-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .product-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .product-image {
      height: 120px;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .product-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .product-name {
      font-weight: 600;
      margin-bottom: 5px;
    }

    .product-price {
      color: var(--accent-color);
      font-weight: 500;
      margin-bottom: 10px;
    }

    .product-quantity {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    .quantity-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .quantity-btn:hover {
      background-color: var(--secondary-color);
      transform: scale(1.1);
    }

    .quantity-value {
      margin: 0 15px;
      font-weight: 600;
    }

    .product-subtotal {
      font-weight: 600;
      text-align: right;
    }

    .delivery-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .delivery-option {
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .delivery-option:hover {
      border-color: var(--primary-color);
      transform: translateY(-3px);
    }

    .delivery-option.selected {
      border-color: var(--primary-color);
      background-color: rgba(93, 64, 55, 0.1);
    }

    .delivery-icon {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .delivery-title {
      font-weight: 600;
      margin-bottom: 5px;
    }

    .delivery-description {
      font-size: 0.9rem;
      color: #666;
    }

    #map {
      height: 300px;
      width: 100%;
      margin-bottom: 20px;
      border-radius: 8px;
    }

    .location-btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      margin-bottom: 20px;
    }

    .location-btn:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .payment-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .payment-option {
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .payment-option:hover {
      border-color: var(--primary-color);
      transform: translateY(-3px);
    }

    .payment-option.selected {
      border-color: var(--primary-color);
      background-color: rgba(93, 64, 55, 0.1);
    }

    .payment-icon {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .payment-title {
      font-weight: 600;
    }

    .order-summary {
      background-color: var(--light-color);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .summary-row.total {
      font-weight: 600;
      font-size: 1.2rem;
      border-top: 1px solid #ddd;
      padding-top: 10px;
    }

    .order-actions {
      display: flex;
      justify-content: space-between;
    }

    .btn-back {
      background-color: #ddd;
      color: var(--text-color);
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn-back:hover {
      background-color: #ccc;
      transform: translateY(-2px);
    }

    .btn-next {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn-next:hover {
      background-color: var(--secondary-color);
      transform: translateY(-2px);
    }

    .btn-pay {
      background-color: var(--success-color);
      color: white;
      border: none;
      padding: 12px 30px;
      border-radius: 4px;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn-pay:hover {
      background-color: #3d8b40;
      transform: translateY(-2px);
    }

    /* Order History Section */
    .order-history {
      padding: 80px 5%;
      background-color: white;
      display: none; /* Initially hidden */
    }

    .order-history.active {
      display: block;
    }

    .history-container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .history-tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 30px;
      border-bottom: 1px solid #ddd;
    }

    .history-tab {
      background: none;
      border: none;
      padding: 15px 30px;
      font-weight: 500;
      cursor: pointer;
      position: relative;
      transition: color 0.3s ease;
    }

    .history-tab:hover {
      color: var(--primary-color);
    }

    .history-tab.active {
      color: var(--primary-color);
    }

    .history-tab.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background-color: var(--primary-color);
    }

    .history-content {
      display: none;
    }

    .history-content.active {
      display: block;
    }

    .order-list {
      display: grid;
      gap: 20px;
    }

    .order-item {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 20px;
      transition: transform 0.3s ease;
    }

    .order-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .order-details h3 {
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .order-info {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 15px;
    }

    .info-item {
      display: flex;
      flex-direction: column;
    }

    .info-label {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 5px;
    }

    .info-value {
      font-weight: 500;
    }

    .order-products {
      margin-top: 15px;
    }

    .product-list-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }

    .product-list-item:last-child {
      border-bottom: none;
    }

    .order-status {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }

    .status-pending {
      background-color: rgba(255, 152, 0, 0.1);
      color: var(--warning-color);
    }

    .status-processing {
      background-color: rgba(33, 150, 243, 0.1);
      color: #2196F3;
    }

    .status-completed {
      background-color: rgba(76, 175, 80, 0.1);
      color: var(--success-color);
    }

    .status-cancelled {
      background-color: rgba(244, 67, 54, 0.1);
      color: var(--danger-color);
    }

    .status-icon {
      font-size: 2rem;
      margin-bottom: 10px;
    }

    .status-text {
      font-weight: 600;
    }

    .empty-history {
      text-align: center;
      padding: 50px 20px;
      color: #666;
    }

    .empty-history i {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #ddd;
    }

    /* Payment Modal */
    .payment-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 3000;
      overflow-y: auto;
    }

    .payment-modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .payment-container {
      background-color: white;
      width: 90%;
      max-width: 500px;
      border-radius: 10px;
      position: relative;
      animation: fadeInUp 0.5s ease;
    }

    .payment-header {
      background-color: var(--primary-color);
      color: white;
      padding: 20px;
      border-radius: 10px 10px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .payment-header h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
    }

    .payment-content {
      padding: 30px;
      text-align: center;
    }

    .payment-image {
      margin: 20px 0;
    }

    .payment-image img {
      max-width: 100%;
      border-radius: 8px;
    }

    .payment-instructions {
      text-align: left;
      background-color: var(--light-color);
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    .payment-instructions h3 {
      margin-bottom: 10px;
      color: var(--primary-color);
    }

    .payment-instructions ol {
      padding-left: 20px;
    }

    .payment-instructions li {
      margin-bottom: 8px;
    }

    .payment-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    /* Country Code Selector */
    .country-selector {
      display: flex;
      align-items: center;
      position: relative;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 0 10px;
      cursor: pointer;
      margin-bottom: 10px;
    }
    .country-selector-display {
      display: flex;
      align-items: center;
      padding: 10px 0;
      width: 100%;
    }
    .country-selector img {
      width: 24px;
      height: 16px;
      margin-right: 8px;
    }
    .country-dropdown {
      position: absolute;
      top: 105%;
      left: 0;
      width: 100%;
      max-height: 200px;
      overflow-y: auto;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      z-index: 1010;
      display: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .country-dropdown.active {
      display: block;
    }
    .country-option {
      display: flex;
      align-items: center;
      padding: 10px;
      cursor: pointer;
    }
    .country-option:hover {
      background-color: #f0f0f0;
    }
    .country-option img {
      margin-right: 10px;
    }
    .country-info {
      display: flex;
      justify-content: space-between;
      width: 100%;
    }
    .country-name {
      font-weight: 500;
    }
    .country-code {
      color: #666;
    }
    #customerPhone {
      padding-left: 10px !important;
    }
    .phone-input-container {
      display: flex;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .phone-code-display {
      display: flex;
      align-items: center;
      padding: 0 12px;
      background-color: #f5f5f5;
      border-right: 1px solid #ddd;
    }
    .phone-code-display img {
      width: 24px;
      margin-right: 8px;
    }

    /* Loading Animation */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    /* Animations */
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
      100% {
        transform: scale(1);
      }
    }

    /* Lazy Loading for Images */
    .lazy {
      opacity: 0;
      transition: opacity 0.3s;
    }

    .lazy.loaded {
      opacity: 1;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .about-content,
      .contact-container {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .header-container {
        padding: 15px 3%;
      }

      nav ul {
        display: none;
        position: absolute;
        top: 70px; /* Adjust to header height */
        left: 0;
        width: 100%;
        background-color: var(--primary-color);
        flex-direction: column;
        padding: 20px;
      }

      nav ul.active {
        display: flex;
      }

      nav ul li {
        margin: 10px 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .hero h1 {
        font-size: 2.5rem;
      }

      .section-title {
        font-size: 2rem;
      }
      
      main > section {
        padding-top: 80px;
      }

      .menu-controls {
        flex-direction: column;
      }

      .search-container {
        width: 100%;
      }

      .order-steps {
        flex-wrap: wrap;
      }

      .step {
        flex-basis: 50%;
        margin-bottom: 20px;
      }

      .order-actions {
        flex-direction: column;
        gap: 10px;
      }

      .btn-back, .btn-next, .btn-pay {
        width: 100%;
      }
    }

    @media (max-width: 576px) {
      .hero h1 {
        font-size: 2rem;
      }

      .hero p {
        font-size: 1rem;
      }

      .menu-items,
      .gallery-grid,
      .testimonials-container {
        grid-template-columns: 1fr;
      }

      .product-list {
        grid-template-columns: 1fr;
      }

      .delivery-options {
        grid-template-columns: 1fr;
      }

      .payment-options {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .order-item {
        grid-template-columns: 1fr;
      }
      
      .order-info {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-container">
      <a href="#" class="logo">
        <img src="logo.jpg" alt="KafeKM9 Logo">
        <h2>KafeKM9</h2>
      </a>
      <nav>
        <ul id="navMenu">
          <li><a href="#home">Beranda</a></li>
          <li><a href="#about">Tentang</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#gallery">Galeri</a></li>
          <li><a href="#testimonials">Testimoni</a></li>
          <li><a href="#contact">Kontak</a></li>
          <li><a href="#orderHistory">Riwayat Pesanan</a></li>
        </ul>
      </nav>
      <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
      </button>
    </div>
  </header>
  
  <!-- Sticky Search Bar -->
  <div class="sticky-search" id="stickySearch">
    <div class="sticky-search-container">
      <input type="text" class="sticky-search-input" id="stickySearchInput" placeholder="Cari menu...">
      <div class="search-suggestions" id="stickySearchSuggestions"></div>
    </div>
  </div>
  
  <main>
    <section class="hero" id="home">
      <div class="hero-content">
        <h1>WarkopKM9 - Sungai Liat</h1>
        <p>Temukan pengalaman kopi yang autentik dengan biji pilihan dan barista berpengalaman</p>
        <a href="#menu" class="btn-primary">Lihat Menu Kami</a>
      </div>
    </section>

    <section class="about" id="about">
      <div class="section-container">
        <h2 class="section-title">Tentang KafeKM9 - Sungai Liat</h2>
        <p class="section-subtitle">Kami adalah kafe yang berdedikasi untuk menyajikan kopi berkualitas tinggi dengan suasana yang nyaman dan hangat</p>
        <div class="about-content">
          <div class="about-text">
            <p>WarkopKM9 didirikan pada tahun 2020 dengan visi untuk menjadi tempat berkumpul favorit bagi para pecinta kopi. Kami percaya bahwa secangkir kopi yang baik dapat mengubah hari Anda menjadi lebih baik.</p>
            <p>Kami menggunakan biji kopi pilihan dari petani lokal dan internasional, yang dipanggang dengan hati-hati untuk menghasilkan cita rasa yang sempurna. Setiap cangkir kopi yang kami sajikan adalah hasil dari dedikasi dan keahlian tim kami.</p>
            <p>Selain kopi, kami juga menyajikan berbagai pilihan makanan lezat yang sempurna menemani waktu santai Anda di WarkopM9.</p>
          </div>
          <div class="about-image">
            <img src="https://i.pinimg.com/736x/26/a3/af/26a3af6550fce0e9cd3cdfff27346fd6.jpg" alt="Tentang KafeKM9">
          </div>
        </div>
      </div>
    </section>

    <section class="menu" id="menu">
      <div class="section-container">
        <h2 class="section-title">Menu Kami</h2>
        <p class="section-subtitle">Pilihan kopi dan makanan lezat yang disiapkan dengan bahan-bahan berkualitas</p>
        
        <div class="menu-controls">
          <div class="menu-categories">
            <button class="category-btn active" data-category="all">Semua</button>
            <button class="category-btn" data-category="coffee">Kopi</button>
            <button class="category-btn" data-category="noncoffee">Non-Kopi</button>
            <button class="category-btn" data-category="food">Makanan</button>
          </div>
          
          <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Cari menu...">
            <button class="search-btn" id="searchBtn">
              <i class="fas fa-search"></i>
            </button>
            <div class="menu-search-suggestions" id="menuSearchSuggestions"></div>
          </div>
        </div>
        
        <div class="menu-items" id="menuItems">
          <div class="loading-container" style="text-align: center; padding: 50px;">
            <div class="loading"></div>
            <p>Memuat menu...</p>
          </div>
        </div>
      </div>
    </section>

    <section class="gallery" id="gallery">
      <div class="section-container">
        <h2 class="section-title">Galeri</h2>
        <p class="section-subtitle">Lihat suasana dan momen indah di KafeKM9</p>
        
        <div class="gallery-grid" id="galleryGrid">
          <div class="loading-container" style="text-align: center; padding: 50px;">
            <div class="loading"></div>
            <p>Memuat galeri...</p>
          </div>
        </div>
      </div>
    </section>

    <section class="testimonials" id="testimonials">
      <div class="section-container">
        <h2 class="section-title">Apa Kata Pelanggan</h2>
        <p class="section-subtitle">Testimoni dari para pelanggan setia kami</p>
        
        <div class="testimonials-container">
          <div class="testimonial-card">
            <p class="testimonial-text">Kopi di sini benar-benar luar biasa! Saya sudah mencoba berbagai kafe di kota ini, tapi KafeKM9 tetap menjadi favorit saya. Suasana yang nyaman dan pelayanan yang ramah membuat saya selalu kembali.</p>
            <div class="testimonial-author">
              <img src="https://picsum.photos/seed/person1/50/50.jpg" alt="Pelanggan" class="testimonial-avatar">
              <div>
                <div class="testimonial-name">Andi Pratama</div>
                <div class="testimonial-role">Pengusaha</div>
              </div>
            </div>
          </div>
          
          <div class="testimonial-card">
            <p class="testimonial-text">Saya sangat suka dengan variasi menu non-kopi mereka. Sebagai orang yang tidak terlalu suka kopi, saya masih bisa menikmati waktu di KafeKM9 dengan minuman dan makanan lezat yang mereka tawarkan.</p>
            <div class="testimonial-author">
              <img src="https://picsum.photos/seed/person2/50/50.jpg" alt="Pelanggan" class="testimonial-avatar">
              <div>
                <div class="testimonial-name">Siti Nurhaliza</div>
                <div class="testimonial-role">Desainer Grafis</div>
              </div>
            </div>
          </div>
          
          <div class="testimonial-card">
            <p class="testimonial-text">Tempat yang sempurna untuk bekerja atau sekadar bersantai. Wi-Fi cepat, colokan banyak, dan tentu saja kopi yang enak. Saya sering menghabiskan waktu berjam-jam di sini tanpa merasa bosan.</p>
            <div class="testimonial-author">
              <img src="https://picsum.photos/seed/person3/50/50.jpg" alt="Pelanggan" class="testimonial-avatar">
              <div>
                <div class="testimonial-name">Budi Santoso</div>
                <div class="testimonial-role">Freelancer</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="contact" id="contact">
      <div class="section-container">
        <h2 class="section-title">Hubungi Kami</h2>
        <p class="section-subtitle">Kunjungi kafe kami atau kirim pesan untuk informasi lebih lanjut</p>
        
        <div class="contact-container">
          <div class="contact-info">
            <div class="contact-item">
              <div class="contact-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="contact-text">
                <h3>Alamat</h3>
                <p id="cafeAddress">Memuat...</p>
              </div>
            </div>
            
            <div class="contact-item">
              <div class="contact-icon">
                <i class="fas fa-phone"></i>
              </div>
              <div class="contact-text">
                <h3>Telepon</h3>
                <p id="cafePhone">Memuat...</p>
              </div>
            </div>
            
            <div class="contact-item">
              <div class="contact-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="contact-text">
                <h3>Email</h3>
                <p id="cafeEmail">Memuat...</p>
              </div>
            </div>
            
            <div class="contact-item">
              <div class="contact-icon">
                <i class="fas fa-clock"></i>
              </div>
              <div class="contact-text">
                <h3>Jam Operasional</h3>
                <p id="cafeHours">Memuat...</p>
              </div>
            </div>
          </div>
          
          <div class="contact-form">
            <form id="contactForm">
              <div class="form-group">
                <label for="contact_name">Nama</label>
                <input type="text" class="form-control" id="contact_name" required>
              </div>
              <div class="form-group">
                <label for="contact_email">Email</label>
                <input type="email" class="form-control" id="contact_email" required>
              </div>
              <div class="form-group">
                <label for="contact_message">Pesan</label>
                <textarea class="form-control" id="contact_message" required></textarea>
              </div>
              <button type="submit" class="btn-submit">Kirim Pesan</button>
            </form>
          </div>
        </div>
      </div>
    </section>

    <section class="order-history" id="orderHistory">
      <div class="history-container">
        <h2 class="section-title">Riwayat Pesanan</h2>
        <p class="section-subtitle">Lihat semua pesanan yang telah Anda buat</p>
        
        <div class="history-tabs">
          <button class="history-tab active" data-tab="all">Semua</button>
          <button class="history-tab" data-tab="pending">Menunggu Pembayaran</button>
          <button class="history-tab" data-tab="processing">Diproses</button>
          <button class="history-tab" data-tab="completed">Selesai</button>
          <button class="history-tab" data-tab="cancelled">Dibatalkan</button>
        </div>
        
        <div class="history-content active" id="allOrders">
          <div class="order-list" id="allOrdersList"></div>
        </div>
        <div class="history-content" id="pendingOrders">
          <div class="order-list" id="pendingOrdersList"></div>
        </div>
        <div class="history-content" id="processingOrders">
          <div class="order-list" id="processingOrdersList"></div>
        </div>
        <div class="history-content" id="completedOrders">
          <div class="order-list" id="completedOrdersList"></div>
        </div>
        <div class="history-content" id="cancelledOrders">
          <div class="order-list" id="cancelledOrdersList"></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-column">
        <h3 id="footerCafeName">KafeKM9</h3>
        <p>Kafe yang menyajikan kopi berkualitas tinggi dengan suasana yang nyaman dan hangat.</p>
        <div class="social-links">
          <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
          <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
          <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
        </div>
      </div>
      
      <div class="footer-column">
        <h3>Menu Cepat</h3>
        <ul>
          <li><a href="#home">Beranda</a></li>
          <li><a href="#about">Tentang</a></li>
          <li><a href="#menu">Menu</a></li>
          <li><a href="#gallery">Galeri</a></li>
          <li><a href="#contact">Kontak</a></li>
        </ul>
      </div>
      
      <div class="footer-column">
        <h3>Menu Kami</h3>
        <ul id="footerMenuList">
        </ul>
      </div>
      
      <div class="footer-column">
        <h3>Newsletter</h3>
        <p>Dapatkan penawaran spesial dan informasi terbaru dari kami</p>
        <form id="newsletterForm">
          <div class="form-group">
            <input type="email" class="form-control" placeholder="Email Anda" required>
          </div>
          <button type="submit" class="btn-submit">Berlangganan</button>
        </form>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p id="footerCopyright">Â© 2023 KafeKM9. Hak Cipta Dilindungi.</p>
    </div>
  </footer>

  <div class="order-modal" id="orderModal">
    <div class="order-container">
      <div class="order-header">
        <h2 id="orderModalTitle">Pesan dari KafeKM9</h2>
        <button class="close-btn" id="closeOrderModal">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="order-content">
        <div class="order-steps">
          <div class="step active" id="step1">
            <div class="step-number">1</div>
            <div class="step-title">Info Pelanggan</div>
          </div>
          <div class="step" id="step2">
            <div class="step-number">2</div>
            <div class="step-title">Pilih Produk</div>
          </div>
          <div class="step" id="step3">
            <div class="step-number">3</div>
            <div class="step-title">Pengiriman</div>
          </div>
          <div class="step" id="step4">
            <div class="step-number">4</div>
            <div class="step-title">Pembayaran</div>
          </div>
        </div>
        
        <div class="order-step-content active" id="step1Content">
          <div class="form-group">
            <label for="customerName">Nama Lengkap</label>
            <input type="text" class="form-control" id="customerName" required>
          </div>
          <div class="form-group">
            <label for="customerPhone">Nomor WhatsApp</label>
            <div class="country-selector" id="countrySelector">
              <div class="country-selector-display">
                <img src="https://flagcdn.com/w20/id.png" alt="Indonesia" id="selectedFlag">
                <span id="selectedCountryCode">+62</span>
                <i class="fas fa-chevron-down" style="margin-left: auto;"></i>
              </div>
              <div class="country-dropdown" id="countryDropdown"></div>
            </div>
            <div class="phone-input-container">
                 <input type="tel" class="form-control" id="customerPhone" placeholder="81234567890" required>
            </div>
          </div>
          <div class="form-group">
            <label for="customerEmail">Email (Opsional)</label>
            <input type="email" class="form-control" id="customerEmail">
          </div>
          <div class="order-actions">
            <div></div>
            <button class="btn-next" id="nextToStep2">Lanjutkan</button>
          </div>
        </div>
        
        <div class="order-step-content" id="step2Content">
          <!-- NEW: Product Summary at the top -->
          <div class="product-summary" id="productSummary">
            <h3>Produk yang Dipilih</h3>
            <div class="summary-items" id="summaryItems"></div>
          </div>
          
          <div class="product-list" id="productList"></div>
          <div class="order-summary">
            <div class="summary-row">
              <span>Subtotal:</span>
              <span id="subtotal">Rp 0</span>
            </div>
            <div class="summary-row">
              <span>Biaya Pengiriman:</span>
              <span id="deliveryFee">Rp 0</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span id="total">Rp 0</span>
            </div>
          </div>
          <div class="order-actions">
            <button class="btn-back" id="backToStep1">Kembali</button>
            <button class="btn-next" id="nextToStep3">Lanjutkan</button>
          </div>
        </div>
        
        <div class="order-step-content" id="step3Content">
          <!-- NEW: Product Summary at the top -->
          <div class="product-summary" id="productSummaryStep3">
            <h3>Produk yang Dipilih</h3>
            <div class="summary-items" id="summaryItemsStep3"></div>
          </div>
          
          <h3>Pilih Opsi Pengiriman</h3>
          <div class="delivery-options">
            <div class="delivery-option" data-delivery="pickup">
              <div class="delivery-icon"><i class="fas fa-store"></i></div>
              <div class="delivery-title">Ambil di Tempat</div>
              <div class="delivery-description">Ambil pesanan Anda langsung di kafe kami</div>
            </div>
            <div class="delivery-option" data-delivery="delivery">
              <div class="delivery-icon"><i class="fas fa-truck"></i></div>
              <div class="delivery-title">Pengiriman</div>
              <div class="delivery-description">Kami antar pesanan ke alamat Anda</div>
            </div>
          </div>
          
          <div id="deliveryOptions" style="display: none;">
            <h3>Alamat Pengiriman</h3>
            <div class="form-group">
              <label for="deliveryAddress">Alamat Lengkap</label>
              <input type="text" class="form-control" id="deliveryAddress">
            </div>
            <div class="form-group">
              <label for="deliveryNotes">Catatan Pengiriman (Opsional)</label>
              <textarea class="form-control" id="deliveryNotes"></textarea>
            </div>
            <h3>Pilih Lokasi di Peta</h3>
            <button class="location-btn" id="getCurrentLocation">
              <i class="fas fa-map-marker-alt"></i> Gunakan Lokasi Saat Ini
            </button>
            <div id="map"></div>
          </div>
          
          <div class="order-actions">
            <button class="btn-back" id="backToStep2">Kembali</button>
            <button class="btn-next" id="nextToStep4" disabled>Lanjutkan</button>
          </div>
        </div>
        
        <div class="order-step-content" id="step4Content">
          <!-- NEW: Product Summary at the top -->
          <div class="product-summary" id="productSummaryStep4">
            <h3>Produk yang Dipilih</h3>
            <div class="summary-items" id="summaryItemsStep4"></div>
          </div>
          
          <h3>Pilih Metode Pembayaran</h3>
          <div class="payment-options">
            <div class="payment-option" data-payment="whatsapp">
              <div class="payment-icon"><i class="fab fa-whatsapp"></i></div>
              <div class="payment-title">WhatsApp</div>
            </div>
            <div class="payment-option" data-payment="qris">
              <div class="payment-icon"><i class="fas fa-qrcode"></i></div>
              <div class="payment-title">QRIS</div>
            </div>
            <div class="payment-option" data-payment="wallet">
              <div class="payment-icon"><i class="fas fa-credit-card"></i></div>
              <div class="payment-title">Payment Wallet</div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="orderNotes">Catatan Pesanan (Opsional)</label>
            <textarea class="form-control" id="orderNotes"></textarea>
          </div>
          
          <div class="order-summary">
            <div class="summary-row">
              <span>Subtotal:</span>
              <span id="finalSubtotal">Rp 0</span>
            </div>
            <div class="summary-row">
              <span>Biaya Pengiriman:</span>
              <span id="finalDeliveryFee">Rp 0</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span id="finalTotal">Rp 0</span>
            </div>
          </div>
          
          <div class="order-actions">
            <button class="btn-back" id="backToStep3">Kembali</button>
            <button class="btn-pay" id="payOrder" disabled>Bayar Sekarang</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="payment-modal" id="paymentModal">
    <div class="payment-container">
      <div class="payment-header">
        <h2>Pembayaran</h2>
        <button class="close-btn" id="closePaymentModal"><i class="fas fa-times"></i></button>
      </div>
      <div class="payment-content">
        <!-- NEW: Product Summary in Payment Modal -->
        <div class="product-summary" id="paymentProductSummary">
          <h3>Detail Pesanan</h3>
          <div class="summary-items" id="paymentSummaryItems"></div>
          <div class="order-summary" style="margin-top: 15px;">
            <div class="summary-row">
              <span>Subtotal:</span>
              <span id="paymentSubtotal">Rp 0</span>
            </div>
            <div class="summary-row">
              <span>Biaya Pengiriman:</span>
              <span id="paymentDeliveryFee">Rp 0</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span id="paymentTotal">Rp 0</span>
            </div>
          </div>
        </div>
        
        <div id="paymentContent"></div>
        <div class="payment-actions">
          <button class="btn-back" id="cancelPayment">Batal</button>
          <button class="btn-next" id="confirmPayment">Saya Sudah Bayar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script>
    // API Configuration
    const BASE_URL = '/api'; // Sesuaikan dengan URL API Anda
    
    // DOM Elements
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const navMenu = document.getElementById('navMenu');
    const categoryBtns = document.querySelectorAll('.category-btn');
    const menuItems = document.getElementById('menuItems');
    const galleryGrid = document.getElementById('galleryGrid');
    const contactForm = document.getElementById('contactForm');
    const newsletterForm = document.getElementById('newsletterForm');
    const toast = document.getElementById('toast');
    const orderModal = document.getElementById('orderModal');
    const closeOrderModal = document.getElementById('closeOrderModal');
    const orderHistoryLink = document.querySelector('a[href="#orderHistory"]');
    const orderHistorySection = document.getElementById('orderHistory');
    const paymentModal = document.getElementById('paymentModal');
    const closePaymentModal = document.getElementById('closePaymentModal');
    const cancelPayment = document.getElementById('cancelPayment');
    const confirmPayment = document.getElementById('confirmPayment');
    const paymentContent = document.getElementById('paymentContent');
    const nextToStep2 = document.getElementById('nextToStep2');
    const backToStep1 = document.getElementById('backToStep1');
    const nextToStep3 = document.getElementById('nextToStep3');
    const backToStep2 = document.getElementById('backToStep2');
    const nextToStep4 = document.getElementById('nextToStep4');
    const backToStep3 = document.getElementById('backToStep3');
    const payOrder = document.getElementById('payOrder');
    const countrySelector = document.getElementById('countrySelector');
    const countryDropdown = document.getElementById('countryDropdown');
    const selectedFlag = document.getElementById('selectedFlag');
    const selectedCountryCode = document.getElementById('selectedCountryCode');
    const customerPhone = document.getElementById('customerPhone');
    const historyTabs = document.querySelectorAll('.history-tab');
    const searchInput = document.getElementById('searchInput');
    const searchBtn = document.getElementById('searchBtn');
    const stickySearch = document.getElementById('stickySearch');
    const stickySearchInput = document.getElementById('stickySearchInput');
    const stickySearchSuggestions = document.getElementById('stickySearchSuggestions');
    const menuSearchSuggestions = document.getElementById('menuSearchSuggestions');
    
    // Global State
    let currentStep = 1;
    let selectedProducts = [];
    let deliveryType = '';
    let paymentType = '';
    let deliveryLocation = null;
    let map = null;
    let marker = null;
    let allMenuItems = [];
    let currentOrderId = null;
    let cafeSettings = {};
    let currentCategory = 'all';
    let searchQuery = '';
    let searchTimeout = null;

    // Country codes
    const countries = [
      { code: '62', name: 'Indonesia', flag: 'https://flagcdn.com/w20/id.png' },
      { code: '60', name: 'Malaysia', flag: 'https://flagcdn.com/w20/my.png' },
      { code: '65', name: 'Singapore', flag: 'https://flagcdn.com/w20/sg.png' }
    ];
    let selectedCountry = countries[0];

    // =============================================================
    // BIAYA PENGIRIMAN - UBAH NILAI DI BAWAH INI UNTUK MENYESUAIKAN BIAYA
    // =============================================================
    const DELIVERY_FEE = 10000; // <--- UBAH BIAYA PENGIRIMAN DI SINI

    // Initialize App
    document.addEventListener('DOMContentLoaded', () => {
      initializeCountrySelector();
      setupEventListeners();
      loadCafeSettings();
      loadMenuItems('all');
      loadGalleryItems();
      setupLazyLoading();
      setupStickySearch();
      setupSearchSuggestions();
    });

    // API Functions
    async function fetchData(tableName) {
      try {
        const response = await fetch(`${BASE_URL}/${tableName}`);
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        const data = await response.json();
        
        // Cek jika data adalah object error dari Supabase (meski status 200)
        if (data.error) {
          throw new Error(data.error);
        }
        
        return data;
      } catch (error) {
        console.error(`Gagal mengambil data untuk ${tableName}:`, error);
        throw error;
      }
    }

    async function postData(tableName, data) {
      try {
        const response = await fetch(`${BASE_URL}/${tableName}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        
        const result = await response.json();
        
        // Cek jika data adalah object error dari Supabase (meski status 200)
        if (result.error) {
          throw new Error(result.error);
        }
        
        return result;
      } catch (error) {
        console.error(`Gagal mengirim data ke ${tableName}:`, error);
        throw error;
      }
    }

    async function updateData(tableName, id, data) {
      try {
        const response = await fetch(`${BASE_URL}/${tableName}/${id}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
        
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        
        const result = await response.json();
        
        // Cek jika data adalah object error dari Supabase (meski status 200)
        if (result.error) {
          throw new Error(result.error);
        }
        
        return result;
      } catch (error) {
        console.error(`Gagal mengupdate data di ${tableName}:`, error);
        throw error;
      }
    }

    // Application Functions
    function setupStickySearch() {
      window.addEventListener('scroll', () => {
        const menuSection = document.getElementById('menu');
        if (menuSection) {
          const menuTop = menuSection.getBoundingClientRect().top;
          if (menuTop <= 70) {
            stickySearch.classList.add('active');
          } else {
            stickySearch.classList.remove('active');
          }
        }
      });

      // Sync search inputs
      stickySearchInput.addEventListener('input', () => {
        searchInput.value = stickySearchInput.value;
        searchQuery = stickySearchInput.value.toLowerCase();
        filterMenuItems();
        showSearchSuggestions(stickySearchInput.value, stickySearchSuggestions);
      });

      searchInput.addEventListener('input', () => {
        stickySearchInput.value = searchInput.value;
        searchQuery = searchInput.value.toLowerCase();
        filterMenuItems();
        showSearchSuggestions(searchInput.value, menuSearchSuggestions);
      });
    }

    function setupSearchSuggestions() {
      // Close suggestions when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.sticky-search-container') && !e.target.closest('.search-container')) {
          stickySearchSuggestions.classList.remove('active');
          menuSearchSuggestions.classList.remove('active');
        }
      });

      // Handle suggestion clicks
      document.addEventListener('click', (e) => {
        if (e.target.closest('.suggestion-item')) {
          const suggestionItem = e.target.closest('.suggestion-item');
          const productId = suggestionItem.dataset.productId;
          
          // Set search input to product name
          const productName = suggestionItem.querySelector('.suggestion-name').textContent;
          searchInput.value = productName;
          stickySearchInput.value = productName;
          
          // Filter menu items
          searchQuery = productName.toLowerCase();
          filterMenuItems();
          
          // Close suggestions
          stickySearchSuggestions.classList.remove('active');
          menuSearchSuggestions.classList.remove('active');
          
          // Scroll to menu section if not already there
          const menuSection = document.getElementById('menu');
          if (menuSection) {
            window.scrollTo({
              top: menuSection.offsetTop - 70,
              behavior: 'smooth'
            });
          }
        }
      });
    }

    function showSearchSuggestions(query, container) {
      if (!query.trim()) {
        container.classList.remove('active');
        return;
      }

      // Clear previous timeout
      if (searchTimeout) {
        clearTimeout(searchTimeout);
      }

      // Debounce search to avoid too many requests
      searchTimeout = setTimeout(() => {
        const suggestions = getSearchSuggestions(query);
        displaySearchSuggestions(suggestions, container);
      }, 300);
    }

    function getSearchSuggestions(query) {
      if (!allMenuItems.length) return [];

      const queryLower = query.toLowerCase();
      const matchedItems = allMenuItems.filter(item => {
        return (
          item.name.toLowerCase().includes(queryLower) ||
          (item.description && item.description.toLowerCase().includes(queryLower)) ||
          item.category.toLowerCase().includes(queryLower)
        );
      });

      // Sort by relevance (exact match first, then partial matches)
      return matchedItems.sort((a, b) => {
        const aNameMatch = a.name.toLowerCase().startsWith(queryLower);
        const bNameMatch = b.name.toLowerCase().startsWith(queryLower);
        
        if (aNameMatch && !bNameMatch) return -1;
        if (!aNameMatch && bNameMatch) return 1;
        
        return a.name.localeCompare(b.name);
      }).slice(0, 5); // Limit to 5 suggestions
    }

    function displaySearchSuggestions(suggestions, container) {
      if (suggestions.length === 0) {
        container.innerHTML = '<div class="no-suggestions">Tidak ada produk yang cocok dengan pencarian Anda</div>';
        container.classList.add('active');
        return;
      }

      const suggestionsHTML = suggestions.map(item => `
        <div class="suggestion-item" data-product-id="${item.id}">
          <div class="suggestion-image">
            <img class="lazy" data-src="${item.image || 'https://picsum.photos/seed/default-product/100/100.jpg'}" alt="${item.name}">
          </div>
          <div class="suggestion-details">
            <div class="suggestion-name">${item.name}</div>
            <div class="suggestion-description">${item.description || 'Tidak ada deskripsi'}</div>
            <div class="suggestion-price">${item.price}</div>
            <div class="suggestion-category">${item.category}</div>
          </div>
        </div>
      `).join('');

      container.innerHTML = suggestionsHTML;
      container.classList.add('active');
      
      // Re-setup lazy loading for new images
      setupLazyLoading();
    }

    function initializeCountrySelector() {
      countries.forEach(country => {
        const option = document.createElement('div');
        option.className = 'country-option';
        option.innerHTML = `<img src="${country.flag}" alt="${country.name}"><div class="country-info"><span class="country-name">${country.name}</span><span class="country-code">+${country.code}</span></div>`;
        option.addEventListener('click', () => selectCountry(country));
        countryDropdown.appendChild(option);
      });
    }

    function selectCountry(country) {
      selectedCountry = country;
      selectedFlag.src = country.flag;
      selectedCountryCode.textContent = `+${country.code}`;
      customerPhone.placeholder = country.code === '62' ? '81234567890' : '81234567890';
      countryDropdown.classList.remove('active');
    }
    
    function setupEventListeners() {
      mobileMenuToggle.addEventListener('click', () => navMenu.classList.toggle('active'));
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            window.scrollTo({ top: target.offsetTop - 70, behavior: 'smooth' });
          }
          navMenu.classList.remove('active');
        });
      });
      categoryBtns.forEach(btn => btn.addEventListener('click', () => {
        categoryBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentCategory = btn.dataset.category;
        filterMenuItems();
      }));
      searchInput.addEventListener('input', () => {
        searchQuery = searchInput.value.toLowerCase();
        filterMenuItems();
      });
      searchBtn.addEventListener('click', () => {
        searchQuery = searchInput.value.toLowerCase();
        filterMenuItems();
      });
      contactForm.addEventListener('submit', e => { e.preventDefault(); submitContactForm(); });
      newsletterForm.addEventListener('submit', e => { e.preventDefault(); submitNewsletterForm(); });
      window.addEventListener('scroll', () => {
        document.querySelector('header').style.backgroundColor = window.scrollY > 100 ? 'rgba(93, 64, 55, 0.95)' : 'var(--primary-color)';
      });
      closeOrderModal.addEventListener('click', () => orderModal.classList.remove('active'));
      closePaymentModal.addEventListener('click', () => paymentModal.classList.remove('active'));
      cancelPayment.addEventListener('click', () => paymentModal.classList.remove('active'));
      confirmPayment.addEventListener('click', confirmPaymentProcess);
      orderHistoryLink.addEventListener('click', () => loadOrderHistory());
      countrySelector.addEventListener('click', () => countryDropdown.classList.toggle('active'));
      document.addEventListener('click', e => {
        if (!countrySelector.contains(e.target)) countryDropdown.classList.remove('active');
      });
      nextToStep2.addEventListener('click', () => validateStep1() && goToStep(2));
      backToStep1.addEventListener('click', () => goToStep(1));
      nextToStep3.addEventListener('click', () => validateStep2() && goToStep(3));
      backToStep2.addEventListener('click', () => goToStep(2));
      nextToStep4.addEventListener('click', () => validateStep3() && goToStep(4));
      backToStep3.addEventListener('click', () => goToStep(3));
      payOrder.addEventListener('click', () => validateStep4() && processPayment());
      document.querySelectorAll('.delivery-option').forEach(option => option.addEventListener('click', function() {
        document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('selected'));
        this.classList.add('selected');
        deliveryType = this.dataset.delivery;
        const isDelivery = deliveryType === 'delivery';
        document.getElementById('deliveryOptions').style.display = isDelivery ? 'block' : 'none';
        if (isDelivery) initMap();
        // Menggunakan biaya pengiriman dari konstanta DELIVERY_FEE
        updateDeliveryFee(isDelivery ? DELIVERY_FEE : 0);
        nextToStep4.disabled = false;
      }));
      document.querySelectorAll('.payment-option').forEach(option => option.addEventListener('click', function() {
        document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
        this.classList.add('selected');
        paymentType = this.dataset.payment;
        payOrder.disabled = false;
      }));
      document.getElementById('getCurrentLocation').addEventListener('click', getCurrentLocation);
      historyTabs.forEach(tab => tab.addEventListener('click', function() {
        historyTabs.forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        document.querySelectorAll('.history-content').forEach(c => c.classList.remove('active'));
        document.getElementById(`${this.dataset.tab}Orders`).classList.add('active');
      }));
    }

    function setupLazyLoading() {
      const lazyImages = document.querySelectorAll('img.lazy');
      
      if ('IntersectionObserver' in window) {
        const imageObserver = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const img = entry.target;
              img.src = img.dataset.src;
              img.classList.add('loaded');
              imageObserver.unobserve(img);
            }
          });
        });
        
        lazyImages.forEach(img => {
          imageObserver.observe(img);
        });
      } else {
        // Fallback for browsers that don't support IntersectionObserver
        let lazyLoadThrottleTimeout;
        
        function lazyLoad() {
          if (lazyLoadThrottleTimeout) {
            clearTimeout(lazyLoadThrottleTimeout);
          }
          
          lazyLoadThrottleTimeout = setTimeout(() => {
            const scrollTop = window.pageYOffset;
            lazyImages.forEach(img => {
              if (img.offsetTop < window.innerHeight + scrollTop) {
                img.src = img.dataset.src;
                img.classList.add('loaded');
              }
            });
            if (lazyImages.length === 0) {
              document.removeEventListener('scroll', lazyLoad);
              window.removeEventListener('resize', lazyLoad);
              window.removeEventListener('orientationChange', lazyLoad);
            }
          }, 20);
        }
        
        document.addEventListener('scroll', lazyLoad);
        window.addEventListener('resize', lazyLoad);
        window.addEventListener('orientationChange', lazyLoad);
      }
    }

    async function loadCafeSettings() {
      try {
        const data = await fetchData('settings');
        if (data && data.length > 0) {
          cafeSettings = data[0];
          document.title = cafeSettings.cafe_name || 'KafeKM9 - Sungai Liat';
          document.querySelector('.logo h2').textContent = cafeSettings.cafe_name || 'KafeKM9';
          document.querySelector('.hero h1').textContent = cafeSettings.cafe_name || 'KafeKM9 - Sungai Liat';
          document.querySelector('.about .section-title').textContent = `Tentang ${cafeSettings.cafe_name || 'KafeKM9'}`;
          document.getElementById('orderModalTitle').textContent = `Pesan dari ${cafeSettings.cafe_name || 'KafeKM9'}`;
          document.getElementById('cafeAddress').textContent = cafeSettings.cafe_address || '';
          document.getElementById('cafePhone').textContent = cafeSettings.cafe_phone || '';
          document.getElementById('cafeEmail').textContent = cafeSettings.cafe_email || '';
          document.getElementById('cafeHours').innerHTML = (cafeSettings.cafe_hours || '').replace(/\n/g, '<br>');
          document.getElementById('footerCafeName').textContent = cafeSettings.cafe_name || 'KafeKM9';
          document.getElementById('footerCopyright').textContent = `Â© ${new Date().getFullYear()} ${cafeSettings.cafe_name || 'KafeKM9'}. Hak Cipta Dilindungi.`;
        }
      } catch (error) {
        console.error("Failed to load cafe settings:", error);
      }
    }
    
    async function loadMenuItems(category) {
      menuItems.innerHTML = '<div class="loading-container" style="text-align: center; padding: 50px;"><div class="loading"></div><p>Memuat menu...</p></div>';
      
      try {
        const data = await fetchData('menu');
        allMenuItems = data || [];
        renderMenuItems(allMenuItems);
        
        // Populate footer menu list
        const footerMenuList = document.getElementById('footerMenuList');
        const categories = [...new Set(allMenuItems.map(item => item.category))];
        footerMenuList.innerHTML = categories.map(cat => `<li><a href="#menu">${cat.charAt(0).toUpperCase() + cat.slice(1)}</a></li>`).join('');
      } catch (error) {
        console.error("Failed to load menu:", error);
        menuItems.innerHTML = '<p>Gagal memuat menu.</p>';
      }
    }

    function filterMenuItems() {
      let filteredItems = allMenuItems;
      
      // Filter by category
      if (currentCategory !== 'all') {
        filteredItems = filteredItems.filter(item => item.category === currentCategory);
      }
      
      // Filter by search query
      if (searchQuery) {
        filteredItems = filteredItems.filter(item => 
          item.name.toLowerCase().includes(searchQuery) || 
          (item.description && item.description.toLowerCase().includes(searchQuery))
        );
      }
      
      renderMenuItems(filteredItems);
    }

    function renderMenuItems(items) {
      if (items.length === 0) {
        menuItems.innerHTML = '<p>Tidak ada menu yang ditemukan.</p>';
        return;
      }
      
      menuItems.innerHTML = items.map(item => `
        <div class="menu-card">
          <div class="menu-card-image">
            <img class="lazy" data-src="${item.image || 'https://picsum.photos/seed/default-menu/400/300.jpg'}" alt="${item.name}">
          </div>
          <div class="menu-card-content">
            <h3 class="menu-card-title">${item.name}</h3>
            <p class="menu-card-description">${item.description || ''}</p>
            <div class="menu-card-footer">
              <span class="menu-card-price">${item.price}</span>
              <button class="menu-card-order" data-product-id="${item.id}">Pesan</button>
            </div>
          </div>
        </div>
      `).join('');
      
      // Re-setup lazy loading for new images
      setupLazyLoading();
      
      // Add event listeners to new order buttons
      document.querySelectorAll('.menu-card-order').forEach(btn => btn.addEventListener('click', e => openOrderModal(e.target.dataset.productId)));
    }

    async function loadGalleryItems() {
      try {
        const data = await fetchData('gallery');
        if (data) {
          galleryGrid.innerHTML = data.map(item => `
            <div class="gallery-item">
              <img class="lazy" data-src="${item.image_url}" alt="${item.title || 'Galeri'}">
              <div class="gallery-overlay"><h4 class="gallery-title">${item.title || ''}</h4></div>
            </div>
          `).join('');
          
          // Re-setup lazy loading for new images
          setupLazyLoading();
        }
      } catch (error) {
        console.error("Failed to load gallery:", error);
        galleryGrid.innerHTML = '<p>Gagal memuat galeri.</p>';
      }
    }

    function openOrderModal(productId) {
      resetOrderForm();
      loadProducts();
      if (productId) {
        setTimeout(() => updateProductQuantity(productId, 1), 100);
      }
      orderModal.classList.add('active');
    }

    function resetOrderForm() {
      currentStep = 1;
      selectedProducts = [];
      deliveryType = '';
      paymentType = '';
      deliveryLocation = null;
      currentOrderId = null;
      goToStep(1);
      ['customerName', 'customerPhone', 'customerEmail', 'deliveryAddress', 'deliveryNotes', 'orderNotes'].forEach(id => document.getElementById(id).value = '');
      document.querySelectorAll('.delivery-option, .payment-option').forEach(el => el.classList.remove('selected'));
      document.getElementById('deliveryOptions').style.display = 'none';
      nextToStep4.disabled = true;
      payOrder.disabled = true;
      if (map) { map.remove(); map = null; marker = null; }
      updateOrderSummary();
      updateProductSummary();
    }

    function loadProducts() {
      productList.innerHTML = allMenuItems.map(product => `
        <div class="product-item">
          <div class="product-image">
            <img class="lazy" data-src="${product.image || 'https://picsum.photos/seed/default-product/400/300.jpg'}" alt="${product.name}">
          </div>
          <div class="product-name">${product.name}</div>
          <div class="product-price">${product.price}</div>
          <div class="product-quantity">
            <button class="quantity-btn" data-action="decrease" data-product-id="${product.id}">-</button>
            <span class="quantity-value" id="quantity-${product.id}">0</span>
            <button class="quantity-btn" data-action="increase" data-product-id="${product.id}">+</button>
          </div>
          <div class="product-subtotal" id="subtotal-${product.id}">Rp 0</div>
        </div>
      `).join('');
      
      // Re-setup lazy loading for new images
      setupLazyLoading();
      
      document.querySelectorAll('.quantity-btn').forEach(btn => btn.addEventListener('click', e => {
        const { action, productId } = e.currentTarget.dataset;
        updateProductQuantity(productId, action === 'increase' ? 1 : -1);
      }));
    }

    function updateProductQuantity(productId, change) {
      const product = allMenuItems.find(p => p.id == productId);
      let pIndex = selectedProducts.findIndex(p => p.id == productId);
      if (pIndex > -1) {
        selectedProducts[pIndex].quantity += change;
        if (selectedProducts[pIndex].quantity <= 0) selectedProducts.splice(pIndex, 1);
      } else if (change > 0) {
        selectedProducts.push({ ...product, quantity: 1 });
      }
      const currentProduct = selectedProducts.find(p => p.id == productId);
      const quantity = currentProduct ? currentProduct.quantity : 0;
      document.getElementById(`quantity-${productId}`).textContent = quantity;
      document.getElementById(`subtotal-${productId}`).textContent = formatCurrency(quantity * extractPrice(product.price));
      updateOrderSummary();
      updateProductSummary();
    }
    
    function extractPrice(priceString) {
      return parseInt(String(priceString).replace(/[^\d]/g, '')) || 0;
    }

    // NEW: Function to update product summary at the top
    function updateProductSummary() {
      const summaryItems = document.getElementById('summaryItems');
      const summaryItemsStep3 = document.getElementById('summaryItemsStep3');
      const summaryItemsStep4 = document.getElementById('summaryItemsStep4');
      const paymentSummaryItems = document.getElementById('paymentSummaryItems');
      
      if (selectedProducts.length === 0) {
        summaryItems.innerHTML = '<p style="text-align: center; color: #666;">Belum ada produk yang dipilih</p>';
        summaryItemsStep3.innerHTML = '<p style="text-align: center; color: #666;">Belum ada produk yang dipilih</p>';
        summaryItemsStep4.innerHTML = '<p style="text-align: center; color: #666;">Belum ada produk yang dipilih</p>';
        paymentSummaryItems.innerHTML = '<p style="text-align: center; color: #666;">Belum ada produk yang dipilih</p>';
        return;
      }
      
      const summaryHTML = selectedProducts.map(product => `
        <div class="summary-item">
          <div class="summary-item-image">
            <img class="lazy" data-src="${product.image || 'https://picsum.photos/seed/default-product/100/100.jpg'}" alt="${product.name}">
          </div>
          <div class="summary-item-details">
            <div class="summary-item-name">${product.name}</div>
            <div class="summary-item-price">${product.price}</div>
          </div>
          <div class="summary-item-quantity">
            <div class="quantity-badge">${product.quantity}</div>
          </div>
        </div>
      `).join('');
      
      summaryItems.innerHTML = summaryHTML;
      summaryItemsStep3.innerHTML = summaryHTML;
      summaryItemsStep4.innerHTML = summaryHTML;
      paymentSummaryItems.innerHTML = summaryHTML;
      
      // Re-setup lazy loading for new images
      setupLazyLoading();
    }

    function updateOrderSummary() {
      const subtotal = selectedProducts.reduce((sum, p) => sum + (extractPrice(p.price) * p.quantity), 0);
      // Menggunakan biaya pengiriman dari konstanta DELIVERY_FEE
      const fee = deliveryType === 'delivery' ? DELIVERY_FEE : 0;
      const total = subtotal + fee;
      ['subtotal', 'finalSubtotal'].forEach(id => document.getElementById(id).textContent = formatCurrency(subtotal));
      ['deliveryFee', 'finalDeliveryFee'].forEach(id => document.getElementById(id).textContent = formatCurrency(fee));
      ['total', 'finalTotal'].forEach(id => document.getElementById(id).textContent = formatCurrency(total));
      
      // Update payment modal summary
      document.getElementById('paymentSubtotal').textContent = formatCurrency(subtotal);
      document.getElementById('paymentDeliveryFee').textContent = formatCurrency(fee);
      document.getElementById('paymentTotal').textContent = formatCurrency(total);
    }

    function updateDeliveryFee(fee) { 
      // Biaya pengiriman saat ini: 5000
      updateOrderSummary(); 
    }
    
    function goToStep(step) {
      currentStep = step;
      document.querySelectorAll('.order-step-content').forEach(el => el.classList.remove('active'));
      document.getElementById(`step${step}Content`).classList.add('active');
      document.querySelectorAll('.step').forEach((el, i) => {
        el.classList.toggle('active', i + 1 === step);
        el.classList.toggle('completed', i + 1 < step);
      });
    }

    function validateStep1() {
      if (!document.getElementById('customerName').value.trim()) return showToast('Nama lengkap harus diisi', 'error'), false;
      if (!document.getElementById('customerPhone').value.trim()) return showToast('Nomor WhatsApp harus diisi', 'error'), false;
      return true;
    }
    function validateStep2() {
      if (selectedProducts.length === 0) return showToast('Pilih minimal satu produk', 'error'), false;
      return true;
    }
    function validateStep3() {
      if (!deliveryType) return showToast('Pilih opsi pengiriman', 'error'), false;
      if (deliveryType === 'delivery' && !document.getElementById('deliveryAddress').value.trim()) return showToast('Alamat pengiriman harus diisi', 'error'), false;
      return true;
    }
    function validateStep4() {
      if (!paymentType) return showToast('Pilih metode pembayaran', 'error'), false;
      return true;
    }

    async function processPayment() {
      const subtotal = selectedProducts.reduce((sum, p) => sum + extractPrice(p.price) * p.quantity, 0);
      // Menggunakan biaya pengiriman dari konstanta DELIVERY_FEE
      const deliveryFee = deliveryType === 'delivery' ? DELIVERY_FEE : 0;
      const total = subtotal + deliveryFee;
      const orderData = {
        menu_item_name: selectedProducts.map(p => `${p.name} (${p.quantity}x)`).join(', '),
        price: formatCurrency(total),
        status: 'pending',
        customer_name: document.getElementById('customerName').value,
        customer_phone: `+${selectedCountry.code}${document.getElementById('customerPhone').value.replace(/[^0-9]/g, '')}`,
        customer_email: document.getElementById('customerEmail').value || null,
        delivery_type: deliveryType,
        delivery_address: deliveryType === 'delivery' ? document.getElementById('deliveryAddress').value : 'Ambil di tempat',
        delivery_notes: document.getElementById('deliveryNotes').value,
        payment_type: paymentType,
        order_notes: document.getElementById('orderNotes').value,
        location_lat: deliveryLocation?.lat,
        location_lng: deliveryLocation?.lng,
        location_share_link: deliveryLocation ? `https://maps.google.com/?q=${deliveryLocation.lat},${deliveryLocation.lng}` : null,
      };

      try {
        const data = await postData('orders', orderData);
        currentOrderId = data[0].id;
        orderModal.classList.remove('active');
        showToast('Pesanan berhasil dibuat!', 'success');

        if (paymentType === 'whatsapp') sendWhatsAppOrder(data[0]);
        else if (paymentType === 'qris') showQRISPayment(data[0]);
        else if (paymentType === 'wallet') processWalletPayment(data[0]);
      } catch (error) {
        showToast(`Gagal membuat pesanan: ${error.message}`, 'error');
      }
    }

    function sendWhatsAppOrder(order) {
      let message = `*HALO ${cafeSettings.cafe_name || 'KafeKM9'}! ðŸŽ‰*\n*PESANAN BARU*\n\n`;
      message += `*ðŸ†” ID Pesanan:* #${order.id}\n`;
      message += `*ðŸ‘¤ Nama:* ${order.customer_name}\n`;
      message += `*ðŸ“± No. WA:* ${order.customer_phone}\n\n`;
      message += `*ðŸ›’ PRODUK:*\n${selectedProducts.map(p => `- ${p.name} (${p.quantity}x)`).join('\n')}\n\n`;
      if (deliveryType === 'delivery') {
        message += `*ðŸšš PENGIRIMAN:*\n*Alamat:* ${order.delivery_address}\n`;
        if(order.location_share_link) message += `*Peta:* ${order.location_share_link}\n`;
      } else {
        message += `*ðŸƒ PENGAMBILAN:* Ambil di Tempat\n`;
      }
      message += `\n*ðŸ’° TOTAL:* *${order.price}*\n\n`;
      message += `_Mohon konfirmasi pesanan ini. Terima kasih! ðŸ™_`;
      
      const url = `https://wa.me/${cafeSettings.cafe_whatsapp || '6283173875972'}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
    }

    function showQRISPayment(order) {
      const productWithQRIS = selectedProducts.find(p => p.payment_image);
      const qrisImage = productWithQRIS?.payment_image || 'https://api.qr-code-generator.com/v1/create?access-token=your-token&qr_code_text=default-text';
      paymentContent.innerHTML = `<h3>Pembayaran QRIS</h3><p>Scan QR code di bawah untuk membayar <strong>${order.price}</strong></p><div class="payment-image"><img src="${qrisImage}" alt="QRIS"></div>`;
      paymentModal.classList.add('active');
    }

    function processWalletPayment(order) {
      const productWithLink = selectedProducts.find(p => p.payment_link);
      const paymentLink = productWithLink?.payment_link || '#';
      paymentContent.innerHTML = `<h3>Pembayaran E-Wallet</h3><p>Klik tombol di bawah untuk membayar <strong>${order.price}</strong></p><button class="btn-primary" onclick="window.open('${paymentLink}', '_blank')">Bayar Sekarang</button>`;
      paymentModal.classList.add('active');
    }

    async function confirmPaymentProcess() {
      if (!currentOrderId) return;
      showToast('Konfirmasi pembayaran diterima. Pesanan Anda sedang diproses.', 'success');
      paymentModal.classList.remove('active');
      await updateOrderStatus(currentOrderId, 'processing');
    }

    async function updateOrderStatus(orderId, status) {
      try {
        await updateData('orders', orderId, { status });
        if (orderHistorySection.classList.contains('active')) loadOrderHistory();
      } catch (error) {
        console.error("Failed to update status:", error);
      }
    }

    async function loadOrderHistory() {
      orderHistorySection.style.display = 'block'; // Ensure section is visible
      try {
        const data = await fetchData('orders');
        const lists = { all: [], pending: [], processing: [], completed: [], cancelled: [] };
        data.forEach(order => {
          lists.all.push(order);
          if (lists[order.status]) lists[order.status].push(order);
        });
        for (const status in lists) {
          displayOrders(`${status}OrdersList`, lists[status]);
        }
      } catch (error) {
        console.error("Failed to load history:", error);
      }
    }

    function displayOrders(containerId, orders) {
      const container = document.getElementById(containerId);
      if (!container) return;
      container.innerHTML = orders.length === 0
        ? `<div class="empty-history"><i class="fas fa-receipt"></i><p>Belum ada pesanan</p></div>`
        : orders.map(order => {
          const statusMap = {
            pending: { text: 'Menunggu', icon: 'fa-clock', class: 'status-pending' },
            processing: { text: 'Diproses', icon: 'fa-spinner', class: 'status-processing' },
            completed: { text: 'Selesai', icon: 'fa-check-circle', class: 'status-completed' },
            cancelled: { text: 'Batal', icon: 'fa-times-circle', class: 'status-cancelled' }
          };
          const s = statusMap[order.status] || { text: 'N/A', icon: 'fa-question-circle', class: '' };
          return `
            <div class="order-item">
              <div class="order-details">
                <h3>Pesanan #${order.id}</h3>
                <div class="order-info">
                  <div class="info-item"><span class="info-label">Tanggal</span><span class="info-value">${new Date(order.created_at).toLocaleString('id-ID')}</span></div>
                  <div class="info-item"><span class="info-label">Nama</span><span class="info-value">${order.customer_name}</span></div>
                  <div class="info-item"><span class="info-label">Produk</span><span class="info-value">${order.menu_item_name}</span></div>
                  <div class="info-item"><span class="info-label">Total</span><span class="info-value">${order.price}</span></div>
                </div>
              </div>
              <div class="order-status ${s.class}">
                <div class="status-icon"><i class="fas ${s.icon}"></i></div>
                <div class="status-text">${s.text}</div>
              </div>
            </div>
          `;
        }).join('');
    }

    function initMap() {
      if (map) return;
      const defaultPos = [-2.13, 106.1]; // Bangka Island coordinates
      map = L.map('map').setView(defaultPos, 13);
           L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: 'Â© OpenStreetMap' }).addTo(map);
      marker = L.marker(defaultPos).addTo(map);
      map.on('click', e => {
        setMarkerLocation(e.latlng.lat, e.latlng.lng);
        getAddressFromCoordinates(e.latlng.lat, e.latlng.lng);
      });
    }
    
    function setMarkerLocation(lat, lng) {
      deliveryLocation = { lat, lng };
      if (marker) marker.setLatLng([lat, lng]);
      else marker = L.marker([lat, lng]).addTo(map);
    }

    function getCurrentLocation() {
      if (!navigator.geolocation) return showToast('Geolocation tidak didukung browser ini.', 'error');
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        setMarkerLocation(latitude, longitude);
        map.setView([latitude, longitude], 15);
        getAddressFromCoordinates(latitude, longitude);
        showToast('Lokasi berhasil didapatkan', 'success');
      }, () => showToast('Gagal mendapatkan lokasi.', 'error'));
    }

    async function getAddressFromCoordinates(lat, lng) {
      try {
        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`);
        const data = await response.json();
        document.getElementById('deliveryAddress').value = data.display_name || `Lat: ${lat}, Lng: ${lng}`;
      } catch (error) {
        console.error('Reverse geocoding failed:', error);
      }
    }
    
    async function submitContactForm() {
      const formData = {
        name: document.getElementById('contact_name').value,
        email: document.getElementById('contact_email').value,
        message: document.getElementById('contact_message').value,
      };
      
      try {
        await postData('contacts', formData);
        showToast('Pesan Anda telah terkirim!', 'success');
        contactForm.reset();
      } catch (error) {
        showToast(`Gagal mengirim pesan: ${error.message}`, 'error');
      }
    }

    function submitNewsletterForm() {
      showToast('Terima kasih telah berlangganan!', 'success');
      newsletterForm.reset();
    }

    function showToast(message, type = 'success') {
      toast.textContent = message;
      toast.className = `toast show ${type}`;
      setTimeout(() => toast.classList.remove('show'), 3000);
    }
    
    function formatCurrency(amount) {
      return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);
    }
  </script>
</body>
</html>
